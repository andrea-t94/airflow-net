{"instruction": "Create an Airflow DAG that demonstrates multiple bash command tasks with different execution patterns, including sequential tasks, looped tasks, and a task that intentionally skips. The DAG should showcase basic task dependencies and bash command execution in an Apache Airflow workflow.", "input": {"airflow_version": "2.7.2"}, "output": "\"\"\"Example DAG demonstrating the usage of the BashOperator.\"\"\"\nfrom __future__ import annotations\n\nimport datetime\n\nimport pendulum\n\nfrom airflow import DAG\nfrom airflow.operators.bash import BashOperator\nfrom airflow.operators.empty import EmptyOperator\n\nwith DAG(\n    dag_id=\"example_bash_operator\",\n    schedule=\"0 0 * * *\",\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    dagrun_timeout=datetime.timedelta(minutes=60),\n    tags=[\"example\", \"example2\"],\n    params={\"example_key\": \"example_value\"},\n) as dag:\n    run_this_last = EmptyOperator(\n        task_id=\"run_this_last\",\n    )\n\n    # [START howto_operator_bash]\n    run_this = BashOperator(\n        task_id=\"run_after_loop\",\n        bash_command=\"echo 1\",\n    )\n    # [END howto_operator_bash]\n\n    run_this >> run_this_last\n\n    for i in range(3):\n        task = BashOperator(\n            task_id=f\"runme_{i}\",\n            bash_command='echo \"{{ task_instance_key_str }}\" && sleep 1',\n        )\n        task >> run_this\n\n    # [START howto_operator_bash_template]\n    also_run_this = BashOperator(\n        task_id=\"also_run_this\",\n        bash_command='echo \"ti_key={{ task_instance_key_str }}\"',\n    )\n    # [END howto_operator_bash_template]\n    also_run_this >> run_this_last\n\n# [START howto_operator_bash_skip]\nthis_will_skip = BashOperator(\n    task_id=\"this_will_skip\",\n    bash_command='echo \"hello world\"; exit 99;',\n    dag=dag,\n)\n# [END howto_operator_bash_skip]\nthis_will_skip >> run_this_last\n\nif __name__ == \"__main__\":\n    dag.test()", "metadata": {"file_name": "dag_0", "instruction_source": "claude-3.5"}}
{"instruction": "Create an Airflow DAG that demonstrates dynamic task branching using the BranchPythonOperator. The DAG should randomly select one of multiple branch paths and execute tasks based on that random selection, with a final join task that runs after the selected branch completes.", "input": {"airflow_version": "2.7.2"}, "output": "\"\"\"Example DAG demonstrating the usage of the BranchPythonOperator.\"\"\"\nfrom __future__ import annotations\n\nimport random\n\nimport pendulum\n\nfrom airflow import DAG\nfrom airflow.operators.empty import EmptyOperator\nfrom airflow.operators.python import BranchPythonOperator\nfrom airflow.utils.edgemodifier import Label\nfrom airflow.utils.trigger_rule import TriggerRule\n\nwith DAG(\n    dag_id=\"example_branch_operator\",\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    schedule=\"@daily\",\n    tags=[\"example\", \"example2\"],\n) as dag:\n    run_this_first = EmptyOperator(\n        task_id=\"run_this_first\",\n    )\n\n    options = [\"branch_a\", \"branch_b\", \"branch_c\", \"branch_d\"]\n\n    branching = BranchPythonOperator(\n        task_id=\"branching\",\n        python_callable=lambda: random.choice(options),\n    )\n    run_this_first >> branching\n\n    join = EmptyOperator(\n        task_id=\"join\",\n        trigger_rule=TriggerRule.NONE_FAILED_MIN_ONE_SUCCESS,\n    )\n\n    for option in options:\n        t = EmptyOperator(\n            task_id=option,\n        )\n\n        empty_follow = EmptyOperator(\n            task_id=\"follow_\" + option,\n        )\n\n        # Label is optional here, but it can help identify more complex branches\n        branching >> Label(option) >> t >> empty_follow >> join", "metadata": {"file_name": "dag_1", "instruction_source": "claude-3.5"}}
{"instruction": "Create an Airflow DAG that demonstrates branching logic based on datetime conditions using the BranchDateTimeOperator. Design a workflow that can conditionally execute different tasks depending on whether the current execution time falls within a specified datetime range.", "input": {"airflow_version": "2.7.2"}, "output": "\"\"\"\nExample DAG demonstrating the usage of DateTimeBranchOperator with datetime as well as time objects as\ntargets.\n\"\"\"\nfrom __future__ import annotations\n\nimport pendulum\n\nfrom airflow import DAG\nfrom airflow.operators.datetime import BranchDateTimeOperator\nfrom airflow.operators.empty import EmptyOperator\n\ndag1 = DAG(\n    dag_id=\"example_branch_datetime_operator\",\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    tags=[\"example\"],\n    schedule=\"@daily\",\n)\n\n# [START howto_branch_datetime_operator]\nempty_task_11 = EmptyOperator(task_id=\"date_in_range\", dag=dag1)\nempty_task_21 = EmptyOperator(task_id=\"date_outside_range\", dag=dag1)\n\ncond1 = BranchDateTimeOperator(\n    task_id=\"datetime_branch\",\n    follow_task_ids_if_true=[\"date_in_range\"],\n    follow_task_ids_if_false=[\"date_outside_range\"],\n    target_upper=pendulum.datetime(2020, 10, 10, 15, 0, 0),\n    target_lower=pendulum.datetime(2020, 10, 10, 14, 0, 0),\n    dag=dag1,\n)\n\n# Run empty_task_11 if cond1 executes between 2020-10-10 14:00:00 and 2020-10-10 15:00:00\ncond1 >> [empty_task_11, empty_task_21]\n# [END howto_branch_datetime_operator]\n\n\ndag2 = DAG(\n    dag_id=\"example_branch_datetime_operator_2\",\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    tags=[\"example\"],\n    schedule=\"@daily\",\n)\n# [START howto_branch_datetime_operator_next_day]\nempty_task_12 = EmptyOperator(task_id=\"date_in_range\", dag=dag2)\nempty_task_22 = EmptyOperator(task_id=\"date_outside_range\", dag=dag2)\n\ncond2 = BranchDateTimeOperator(\n    task_id=\"datetime_branch\",\n    follow_task_ids_if_true=[\"date_in_range\"],\n    follow_task_ids_if_false=[\"date_outside_range\"],\n    target_upper=pendulum.time(0, 0, 0),\n    target_lower=pendulum.time(15, 0, 0),\n    dag=dag2,\n)\n\n# Since target_lower happens after target_upper, target_upper will be moved to the following day\n# Run empty_task_12 if cond2 executes between 15:00:00, and 00:00:00 of the following day\ncond2 >> [empty_task_12, empty_task_22]\n# [END howto_branch_datetime_operator_next_day]\n\ndag3 = DAG(\n    dag_id=\"example_branch_datetime_operator_3\",\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    tags=[\"example\"],\n    schedule=\"@daily\",\n)\n# [START howto_branch_datetime_operator_logical_date]\nempty_task_13 = EmptyOperator(task_id=\"date_in_range\", dag=dag3)\nempty_task_23 = EmptyOperator(task_id=\"date_outside_range\", dag=dag3)\n\ncond3 = BranchDateTimeOperator(\n    task_id=\"datetime_branch\",\n    use_task_logical_date=True,\n    follow_task_ids_if_true=[\"date_in_range\"],\n    follow_task_ids_if_false=[\"date_outside_range\"],\n    target_upper=pendulum.datetime(2020, 10, 10, 15, 0, 0),\n    target_lower=pendulum.datetime(2020, 10, 10, 14, 0, 0),\n    dag=dag3,\n)\n\n# Run empty_task_13 if cond3 executes between 2020-10-10 14:00:00 and 2020-10-10 15:00:00\ncond3 >> [empty_task_13, empty_task_23]\n# [END howto_branch_datetime_operator_logical_date]", "metadata": {"file_name": "dag_2", "instruction_source": "claude-3.5"}}
{"instruction": "Create an Airflow DAG that demonstrates dynamic task selection based on the current minute's parity. Design a workflow where a branching task decides which of two parallel tasks will execute, showcasing conditional task routing in Airflow.", "input": {"airflow_version": "2.7.2"}, "output": "\"\"\"\nExample DAG demonstrating the usage of ``@task.branch`` TaskFlow API decorator with depends_on_past=True,\nwhere tasks may be run or skipped on alternating runs.\n\"\"\"\nfrom __future__ import annotations\n\nimport pendulum\n\nfrom airflow import DAG\nfrom airflow.decorators import task\nfrom airflow.operators.empty import EmptyOperator\n\n\n@task.branch()\ndef should_run(**kwargs) -> str:\n    \"\"\"\n    Determine which empty_task should be run based on if the execution date minute is even or odd.\n\n    :param dict kwargs: Context\n    :return: Id of the task to run\n    \"\"\"\n    print(\n        f\"------------- exec dttm = {kwargs['execution_date']} and minute = {kwargs['execution_date'].minute}\"\n    )\n    if kwargs[\"execution_date\"].minute % 2 == 0:\n        return \"empty_task_1\"\n    else:\n        return \"empty_task_2\"\n\n\nwith DAG(\n    dag_id=\"example_branch_dop_operator_v3\",\n    schedule=\"*/1 * * * *\",\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    default_args={\"depends_on_past\": True},\n    tags=[\"example\"],\n) as dag:\n    cond = should_run()\n\n    empty_task_1 = EmptyOperator(task_id=\"empty_task_1\")\n    empty_task_2 = EmptyOperator(task_id=\"empty_task_2\")\n    cond >> [empty_task_1, empty_task_2]", "metadata": {"file_name": "dag_3", "instruction_source": "claude-3.5"}}
{"instruction": "Create an Airflow DAG that demonstrates a complex workflow with multiple tasks representing data catalog operations like creating, deleting, getting, and listing entries, tags, and tag templates. Design the DAG to showcase task dependencies and different stages of data catalog management.", "input": {"airflow_version": "2.7.2"}, "output": "\"\"\"\nExample Airflow DAG that shows the complex DAG structure.\n\"\"\"\nfrom __future__ import annotations\n\nimport pendulum\n\nfrom airflow import models\nfrom airflow.models.baseoperator import chain\nfrom airflow.operators.bash import BashOperator\n\nwith models.DAG(\n    dag_id=\"example_complex\",\n    schedule=None,\n    start_date=pendulum.datetime(2021, 1, 1, tz=\"UTC\"),\n    catchup=False,\n    tags=[\"example\", \"example2\", \"example3\"],\n) as dag:\n    # Create\n    create_entry_group = BashOperator(task_id=\"create_entry_group\", bash_command=\"echo create_entry_group\")\n\n    create_entry_group_result = BashOperator(\n        task_id=\"create_entry_group_result\", bash_command=\"echo create_entry_group_result\"\n    )\n\n    create_entry_group_result2 = BashOperator(\n        task_id=\"create_entry_group_result2\", bash_command=\"echo create_entry_group_result2\"\n    )\n\n    create_entry_gcs = BashOperator(task_id=\"create_entry_gcs\", bash_command=\"echo create_entry_gcs\")\n\n    create_entry_gcs_result = BashOperator(\n        task_id=\"create_entry_gcs_result\", bash_command=\"echo create_entry_gcs_result\"\n    )\n\n    create_entry_gcs_result2 = BashOperator(\n        task_id=\"create_entry_gcs_result2\", bash_command=\"echo create_entry_gcs_result2\"\n    )\n\n    create_tag = BashOperator(task_id=\"create_tag\", bash_command=\"echo create_tag\")\n\n    create_tag_result = BashOperator(task_id=\"create_tag_result\", bash_command=\"echo create_tag_result\")\n\n    create_tag_result2 = BashOperator(task_id=\"create_tag_result2\", bash_command=\"echo create_tag_result2\")\n\n    create_tag_template = BashOperator(task_id=\"create_tag_template\", bash_command=\"echo create_tag_template\")\n\n    create_tag_template_result = BashOperator(\n        task_id=\"create_tag_template_result\", bash_command=\"echo create_tag_template_result\"\n    )\n\n    create_tag_template_result2 = BashOperator(\n        task_id=\"create_tag_template_result2\", bash_command=\"echo create_tag_template_result2\"\n    )\n\n    create_tag_template_field = BashOperator(\n        task_id=\"create_tag_template_field\", bash_command=\"echo create_tag_template_field\"\n    )\n\n    create_tag_template_field_result = BashOperator(\n        task_id=\"create_tag_template_field_result\", bash_command=\"echo create_tag_template_field_result\"\n    )\n\n    create_tag_template_field_result2 = BashOperator(\n        task_id=\"create_tag_template_field_result2\", bash_command=\"echo create_tag_template_field_result\"\n    )\n\n    # Delete\n    delete_entry = BashOperator(task_id=\"delete_entry\", bash_command=\"echo delete_entry\")\n    create_entry_gcs >> delete_entry\n\n    delete_entry_group = BashOperator(task_id=\"delete_entry_group\", bash_command=\"echo delete_entry_group\")\n    create_entry_group >> delete_entry_group\n\n    delete_tag = BashOperator(task_id=\"delete_tag\", bash_command=\"echo delete_tag\")\n    create_tag >> delete_tag\n\n    delete_tag_template_field = BashOperator(\n        task_id=\"delete_tag_template_field\", bash_command=\"echo delete_tag_template_field\"\n    )\n\n    delete_tag_template = BashOperator(task_id=\"delete_tag_template\", bash_command=\"echo delete_tag_template\")\n\n    # Get\n    get_entry_group = BashOperator(task_id=\"get_entry_group\", bash_command=\"echo get_entry_group\")\n\n    get_entry_group_result = BashOperator(\n        task_id=\"get_entry_group_result\", bash_command=\"echo get_entry_group_result\"\n    )\n\n    get_entry = BashOperator(task_id=\"get_entry\", bash_command=\"echo get_entry\")\n\n    get_entry_result = BashOperator(task_id=\"get_entry_result\", bash_command=\"echo get_entry_result\")\n\n    get_tag_template = BashOperator(task_id=\"get_tag_template\", bash_command=\"echo get_tag_template\")\n\n    get_tag_template_result = BashOperator(\n        task_id=\"get_tag_template_result\", bash_command=\"echo get_tag_template_result\"\n    )\n\n    # List\n    list_tags = BashOperator(task_id=\"list_tags\", bash_command=\"echo list_tags\")\n\n    list_tags_result = BashOperator(task_id=\"list_tags_result\", bash_command=\"echo list_tags_result\")\n\n    # Lookup\n    lookup_entry = BashOperator(task_id=\"lookup_entry\", bash_command=\"echo lookup_entry\")\n\n    lookup_entry_result = BashOperator(task_id=\"lookup_entry_result\", bash_command=\"echo lookup_entry_result\")\n\n    # Rename\n    rename_tag_template_field = BashOperator(\n        task_id=\"rename_tag_template_field\", bash_command=\"echo rename_tag_template_field\"\n    )\n\n    # Search\n    search_catalog = BashOperator(task_id=\"search_catalog\", bash_command=\"echo search_catalog\")\n\n    search_catalog_result = BashOperator(\n        task_id=\"search_catalog_result\", bash_command=\"echo search_catalog_result\"\n    )\n\n    # Update\n    update_entry = BashOperator(task_id=\"update_entry\", bash_command=\"echo update_entry\")\n\n    update_tag = BashOperator(task_id=\"update_tag\", bash_command=\"echo update_tag\")\n\n    update_tag_template = BashOperator(task_id=\"update_tag_template\", bash_command=\"echo update_tag_template\")\n\n    update_tag_template_field = BashOperator(\n        task_id=\"update_tag_template_field\", bash_command=\"echo update_tag_template_field\"\n    )\n\n    # Create\n    create_tasks = [\n        create_entry_group,\n        create_entry_gcs,\n        create_tag_template,\n        create_tag_template_field,\n        create_tag,\n    ]\n    chain(*create_tasks)\n\n    create_entry_group >> delete_entry_group\n    create_entry_group >> create_entry_group_result\n    create_entry_group >> create_entry_group_result2\n\n    create_entry_gcs >> delete_entry\n    create_entry_gcs >> create_entry_gcs_result\n    create_entry_gcs >> create_entry_gcs_result2\n\n    create_tag_template >> delete_tag_template_field\n    create_tag_template >> create_tag_template_result\n    create_tag_template >> create_tag_template_result2\n\n    create_tag_template_field >> delete_tag_template_field\n    create_tag_template_field >> create_tag_template_field_result\n    create_tag_template_field >> create_tag_template_field_result2\n\n    create_tag >> delete_tag\n    create_tag >> create_tag_result\n    create_tag >> create_tag_result2\n\n    # Delete\n    delete_tasks = [\n        delete_tag,\n        delete_tag_template_field,\n        delete_tag_template,\n        delete_entry_group,\n        delete_entry,\n    ]\n    chain(*delete_tasks)\n\n    # Get\n    create_tag_template >> get_tag_template >> delete_tag_template\n    get_tag_template >> get_tag_template_result\n\n    create_entry_gcs >> get_entry >> delete_entry\n    get_entry >> get_entry_result\n\n    create_entry_group >> get_entry_group >> delete_entry_group\n    get_entry_group >> get_entry_group_result\n\n    # List\n    create_tag >> list_tags >> delete_tag\n    list_tags >> list_tags_result\n\n    # Lookup\n    create_entry_gcs >> lookup_entry >> delete_entry\n    lookup_entry >> lookup_entry_result\n\n    # Rename\n    create_tag_template_field >> rename_tag_template_field >> delete_tag_template_field\n\n    # Search\n    chain(create_tasks, search_catalog, delete_tasks)\n    search_catalog >> search_catalog_result\n\n    # Update\n    create_entry_gcs >> update_entry >> delete_entry\n    create_tag >> update_tag >> delete_tag\n    create_tag_template >> update_tag_template >> delete_tag_template\n    create_tag_template_field >> update_tag_template_field >> rename_tag_template_field", "metadata": {"file_name": "dag_4", "instruction_source": "claude-3.5"}}
